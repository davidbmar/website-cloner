<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Website Cloner - Web UI</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div>
                    <h1>üåê Website Cloner</h1>
                    <p class="subtitle">Clone websites to S3 with ease</p>
                </div>
                <div class="header-buttons">
                    <div class="user-profile" id="userProfile">
                        <span class="user-display" id="userDisplay">üë§ Not signed in</span>
                        <button class="user-btn" onclick="showUserDialog()" title="Sign in">Sign In</button>
                    </div>
                    <button class="portfolio-btn" onclick="openPortfolio()" title="View all cloned sites">
                        üìÅ Portfolio
                    </button>
                    <button class="rationale-toggle" onclick="toggleRationale()" title="View Rationale & First Principles">
                        üìñ Why S3?
                    </button>
                </div>
            </div>
        </header>

        <div class="quick-start">
            <h3>Quick Start Templates</h3>
            <p class="quick-start-desc">Clone popular sites to S3 static hosting with one click. Select a template to auto-fill settings.</p>
            <div class="template-buttons">
                <button class="template-btn" onclick="loadTemplate('capsule')" title="Clone Capsule.com marketing site to S3">
                    <span class="btn-icon">üåê</span>
                    <span class="btn-text">
                        <strong>Capsule.com</strong>
                        <small>‚Üí S3 Clone</small>
                    </span>
                </button>
                <button class="template-btn" onclick="loadTemplate('localhost')" title="Clone local development site">üìç Localhost:8080</button>
                <button class="template-btn" onclick="loadTemplate('otter')" title="Clone Otter.ai to S3">ü¶¶ Otter.ai</button>
                <button class="template-btn" onclick="loadTemplate('example')" title="Simple test site">‚úÖ Example.com</button>
                <button class="template-btn" onclick="loadTemplate('cnn')" title="Clone CNN news site">üì∞ CNN</button>
                <button class="template-btn" onclick="loadTemplate('slashdot')" title="Clone Slashdot tech news">‚ö° Slashdot</button>
                <button class="template-btn" onclick="loadTemplate('custom')" title="Configure manually">‚öôÔ∏è Custom</button>
            </div>
        </div>

        <form id="cloneForm">
            <!-- Target Configuration -->
            <section class="form-section">
                <h2>Target Website</h2>
                <div class="form-group">
                    <label for="targetUrl">Website URL *</label>
                    <input type="text" id="targetUrl" name="targetUrl"
                           placeholder="https://example.com or http://localhost:8080" required>
                    <small>The website you want to clone</small>
                </div>
                <div class="form-group">
                    <label for="description">Description (optional)</label>
                    <input type="text" id="description" name="description"
                           placeholder="My awesome website">
                </div>
            </section>

            <!-- Crawling Configuration -->
            <section class="form-section collapsible">
                <h2 onclick="toggleSection(this)">
                    <span class="toggle-icon">‚ñº</span> Crawling Options
                </h2>
                <div class="section-content">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="maxDepth">Max Depth</label>
                            <input type="number" id="maxDepth" name="maxDepth" value="5" min="0" max="10">
                            <small>How many links deep to crawl (0 = homepage only)</small>
                        </div>
                        <div class="form-group">
                            <label for="maxPages">Max Pages</label>
                            <input type="number" id="maxPages" name="maxPages" value="500" min="1" max="10000">
                            <small>Maximum number of pages to download</small>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="sameDomainOnly" name="sameDomainOnly" checked>
                            Same domain only
                        </label>
                        <small>Only crawl pages on the same domain</small>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="respectRobotsTxt" name="respectRobotsTxt" checked>
                            Respect robots.txt
                        </label>
                        <small>Follow the site's robots.txt rules</small>
                    </div>
                    <div class="form-group">
                        <label for="ignorePatterns">Ignore Patterns (one per line)</label>
                        <textarea id="ignorePatterns" name="ignorePatterns" rows="4"
                                  placeholder="**/logout&#10;**/admin/**&#10;**/login"></textarea>
                        <small>URL patterns to skip (glob format)</small>
                    </div>
                </div>
            </section>

            <!-- Asset Configuration -->
            <section class="form-section collapsible">
                <h2 onclick="toggleSection(this)">
                    <span class="toggle-icon">‚ñº</span> Asset Options
                </h2>
                <div class="section-content">
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="downloadImages" name="downloadImages" checked>
                            Download images
                        </label>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="downloadCSS" name="downloadCSS" checked>
                            Download CSS files
                        </label>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="downloadJS" name="downloadJS" checked>
                            Download JavaScript files
                        </label>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="downloadFonts" name="downloadFonts" checked>
                            Download fonts
                        </label>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="downloadVideos" name="downloadVideos">
                            Download videos
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="maxFileSize">Max File Size (MB)</label>
                        <input type="number" id="maxFileSize" name="maxFileSize" value="10" min="1" max="100">
                        <small>Skip files larger than this size</small>
                    </div>
                </div>
            </section>

            <!-- S3 Configuration -->
            <section class="form-section collapsible">
                <h2 onclick="toggleSection(this)">
                    <span class="toggle-icon">‚ñº</span> S3 Deployment
                </h2>
                <div class="section-content">
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="s3Enabled" name="s3Enabled" checked>
                            Enable S3 upload
                        </label>
                        <small>Deploy the cloned site to S3</small>
                    </div>
                    <div class="form-group">
                        <label for="s3Bucket">S3 Bucket Name *</label>
                        <input type="text" id="s3Bucket" name="s3Bucket"
                               placeholder="my-cloned-websites">
                        <small>The S3 bucket to upload to</small>
                    </div>
                    <div class="form-group">
                        <label for="s3Region">AWS Region</label>
                        <input type="text" id="s3Region" name="s3Region" value="us-east-1"
                               placeholder="us-east-1">
                        <small>AWS region for the S3 bucket</small>
                    </div>
                    <div class="form-group">
                        <label for="s3Prefix">S3 Prefix (optional)</label>
                        <input type="text" id="s3Prefix" name="s3Prefix"
                               placeholder="my-site">
                        <small>Subdirectory in the bucket (leave empty for root)</small>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="configureWebsiteHosting" name="configureWebsiteHosting" checked>
                            Configure static website hosting
                        </label>
                        <small>Automatically set up the bucket for web hosting</small>
                    </div>
                </div>
            </section>

            <!-- Network Configuration -->
            <section class="form-section collapsible collapsed">
                <h2 onclick="toggleSection(this)">
                    <span class="toggle-icon">‚ñ∂</span> Advanced Options
                </h2>
                <div class="section-content" style="display: none;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="concurrency">Concurrency</label>
                            <input type="number" id="concurrency" name="concurrency" value="5" min="1" max="20">
                            <small>Number of parallel downloads</small>
                        </div>
                        <div class="form-group">
                            <label for="requestsPerSecond">Requests per Second</label>
                            <input type="number" id="requestsPerSecond" name="requestsPerSecond" value="2" min="1" max="10">
                            <small>Rate limit to respect target server</small>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="timeout">Timeout (seconds)</label>
                        <input type="number" id="timeout" name="timeout" value="30" min="5" max="120">
                        <small>Request timeout in seconds</small>
                    </div>
                </div>
            </section>

            <!-- Action Buttons -->
            <div class="actions">
                <button type="button" class="btn btn-secondary" onclick="previewConfig()">
                    üìã Preview Config
                </button>
                <button type="button" class="btn btn-primary" onclick="startEnumeration()">
                    üîç Step 1: Enumerate URLs
                </button>
                <button type="button" class="btn btn-primary" id="downloadBtn" onclick="startDownload()" disabled>
                    ‚¨áÔ∏è Step 2: Download & Deploy
                </button>
                <button type="button" class="btn btn-success" onclick="startFull()">
                    üöÄ Run Full Clone
                </button>
            </div>
        </form>

        <!-- Progress Section -->
        <div id="progressSection" class="progress-section" style="display: none;">
            <h2>Progress</h2>
            <div class="progress-bar">
                <div id="progressFill" class="progress-fill"></div>
            </div>
            <div id="progressText" class="progress-text">Ready to start...</div>
            <div id="logOutput" class="log-output"></div>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="results-section" style="display: none;">
            <h2>Results</h2>
            <div id="resultsContent" class="results-content"></div>
        </div>

        <!-- Config Preview Modal -->
        <div id="configModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Configuration Preview</h2>
                    <button class="close-btn" onclick="closeModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <pre id="configPreview"></pre>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal()">Close</button>
                    <button class="btn btn-primary" onclick="downloadConfig()">Download Config</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Portfolio Modal -->
    <div id="portfolioModal" class="modal" style="display: none;">
        <div class="modal-content portfolio-modal">
            <div class="modal-header">
                <h2>üìÅ Cloned Sites Portfolio</h2>
                <button class="close-btn" onclick="closePortfolio()">&times;</button>
            </div>
            <div class="modal-body">
                <p class="portfolio-intro">All websites you've cloned to S3 static hosting</p>
                <div id="portfolioLoading" class="portfolio-loading">
                    <div class="spinner"></div>
                    <p>Loading your cloned sites...</p>
                </div>
                <div id="portfolioContent" class="portfolio-grid" style="display: none;">
                    <!-- Portfolio items will be inserted here -->
                </div>
                <div id="portfolioEmpty" class="portfolio-empty" style="display: none;">
                    <p>No cloned sites found yet.</p>
                    <p class="hint">Clone your first site using the templates above!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Rationale Side Panel -->
    <div id="rationalePanel" class="rationale-panel">
        <div class="rationale-content">
            <div class="rationale-header">
                <h2>First Principles: Why S3?</h2>
                <button class="close-rationale" onclick="toggleRationale()" title="Close">&times;</button>
            </div>
            <div class="rationale-body">
                <section class="rationale-section">
                    <h3>Purpose</h3>
                    <p>The primary purpose of a website is to deliver information reliably, economically, and at scale. Any architectural choice must therefore be evaluated by how well it serves this objective over time, not by technical novelty or completeness.</p>
                    <p class="principle">The default assumption should be that content is <strong>static</strong> unless there is a demonstrated and sustained need for dynamic behavior.</p>
                </section>

                <section class="rationale-section">
                    <h3>Decision</h3>
                    <p>Use Amazon S3 as the foundational substrate for hosting and cloning websites by flattening content into static assets (HTML, CSS, JavaScript, media).</p>
                </section>

                <section class="rationale-section">
                    <h3>Rationale</h3>

                    <div class="rationale-item">
                        <h4>üí∞ Cost Discipline</h4>
                        <p>Infrastructure decisions are long-term commitments. Database- and server-centric architectures impose fixed and recurring costs regardless of utilization. S3 operates on a variable cost model aligned with actual usage. Costs scale linearly with value delivered, making the system economically sustainable from inception through growth.</p>
                    </div>

                    <div class="rationale-item">
                        <h4>üõ°Ô∏è Reliability Through Simplicity</h4>
                        <p>Reliability increases as decision points decrease. Each additional runtime component introduces failure modes and operational overhead. An S3-backed website removes entire classes of failures by eliminating servers, application runtimes, and databases from the critical path. Content delivery becomes a simple retrieval operation.</p>
                    </div>

                    <div class="rationale-item">
                        <h4>üìà Scalability Without Reorganization</h4>
                        <p>S3 scales by default. Growth in traffic does not require architectural redesign, operational intervention, or proportional increases in staffing. This preserves organizational focus on outcomes rather than internal complexity.</p>
                    </div>

                    <div class="rationale-item">
                        <h4>üîí Security by Structure</h4>
                        <p>Security is most effective when enforced by architecture, not behavior. Static content served from S3 has no execution context and therefore a sharply reduced attack surface. Public access is read-only; write access is tightly controlled. Risk is constrained by design rather than policy alone.</p>
                    </div>

                    <div class="rationale-item">
                        <h4>üì¶ Content as a Durable Asset</h4>
                        <p>Flattening a website converts content from a process into an asset. Static artifacts are portable, auditable, versionable, and reproducible. Sites can be cloned, archived, or redeployed without recreating application environments. Knowledge becomes durable and independent of the systems that produced it.</p>
                    </div>

                    <div class="rationale-item">
                        <h4>üîÄ Optionality and Incremental Complexity</h4>
                        <p>Starting with S3 establishes a disciplined baseline. More complex capabilities‚ÄîAPIs, personalization, computation‚Äîcan be layered on only when clearly justified. This avoids premature commitment and preserves strategic flexibility.</p>
                    </div>
                </section>

                <section class="rationale-section conclusion">
                    <h3>Conclusion</h3>
                    <p>Using S3 as the foundation for website deployment is not a technical shortcut; it is a <strong>managerial decision</strong>. It minimizes cost, reduces risk, increases reliability, and preserves optionality while fully satisfying the system's primary purpose.</p>
                    <p class="conclusion-emphasis">It does the right thing‚Äîand does it efficiently.</p>
                </section>
            </div>
        </div>
    </div>

    <script src="/app.js"></script>
</body>
</html>
